<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1250">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.1.3  (Win32)">
	<META NAME="AUTHOR" CONTENT="Piotr Tutak">
	<META NAME="CREATED" CONTENT="20171017;17362255">
	<META NAME="CHANGEDBY" CONTENT="Piotr Tutak">
	<META NAME="CHANGED" CONTENT="20171019;16574646">
	<META NAME="Category" CONTENT="">
	<META NAME="Company" CONTENT="">
	<META NAME="Editor" CONTENT="OpenOffice/4.1.3$Win32 OpenOffice.org_project/413m1$Build-9783">
	<META NAME="HyperlinkBase" CONTENT="">
	<META NAME="Language" CONTENT="">
	<META NAME="Manager" CONTENT="">
	<META NAME="Version" CONTENT="">
	<STYLE TYPE="text/css">
	<!--
		P { margin-bottom: 0.21cm }
		A:link { color: #000080; so-language: zxx; text-decoration: underline }
		A:visited { color: #800000; so-language: zxx; text-decoration: underline }
	-->
	</STYLE>
</HEAD>
<BODY LANG="pl-PL" LINK="#000080" VLINK="#800000" DIR="LTR">
<P STYLE="margin-bottom: 0cm">Podstawy Sztucznej Inteligencji &ndash;
æwiczenia projektowe</P>
<P STYLE="margin-bottom: 0cm">Sprawozdanie &ndash; 20.10.2017</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">W zadaniu zosta³a wykorzystana metoda
uczenia, o której mo¿na przeczytaæ po adresem:</P>
<P STYLE="margin-bottom: 0cm"><A HREF="http://edu.pjwstk.edu.pl/wyklady/nai/scb/wyklad3/w3.htm">http://edu.pjwstk.edu.pl/wyklady/nai/scb/wyklad3/w3.htm</A></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">Polega ona na modyfikacji wag
perceptronu poprzez porównanie otrzymanego wyniku z wynikiem
oczekiwanym i takiej zmianie wag, by bra³y pod uwagê wspó³czynnik
uczenia i ró¿nicê miêdzy wynikiem, a wartoœci¹ oczekiwan¹ zgodnie ze
wzorem:</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm; font-weight: normal"><I>w</I><SUB><I>1
</I></SUB><I>+= </I><SPAN LANG="en-US"><I>n * </I></SPAN><SPAN LANG="en-US">(</SPAN><SPAN LANG="en-US"><I>d-y</I></SPAN><SPAN LANG="en-US">)
</SPAN><I>* x</I><SUB><I>1</I></SUB><I><BR>w</I><SUB><I>2 </I></SUB><I>+=
</I><SPAN LANG="en-US"><I>n </I></SPAN><SPAN LANG="en-US">* (</SPAN><SPAN LANG="en-US"><I>d-y</I></SPAN><SPAN LANG="en-US">)
</SPAN><I>* x</I><SUB><I>2</I></SUB><I><BR></I><SPAN LANG="en-US"><I>b
  +</I></SPAN><I>= </I><SPAN LANG="en-US"><I>n * </I></SPAN><SPAN LANG="en-US">(</SPAN><SPAN LANG="en-US"><I>d-y</I></SPAN><SPAN LANG="en-US">)</SPAN></P>
<P STYLE="margin-bottom: 0cm; font-style: normal; font-weight: normal">
<BR>
</P>
<P STYLE="margin-bottom: 0cm; font-style: normal; font-weight: normal">
gdzie:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal"><SPAN LANG="en-US"><I>w</I></SPAN><SUB><SPAN LANG="en-US"><I>1</I></SPAN></SUB><SPAN LANG="en-US"><I>,</I></SPAN><SUB><SPAN LANG="en-US"><I>
	</I></SPAN></SUB><SPAN LANG="en-US"><I>w</I></SPAN><SUB><SPAN LANG="en-US"><I>2</I></SPAN></SUB><SPAN LANG="en-US"><I>
	&ndash;</I></SPAN><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">
	wagi</SPAN></SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm; font-weight: normal"><SPAN LANG="en-US"><I>x</I></SPAN><SUB><SPAN LANG="en-US"><I>1</I></SPAN></SUB><SPAN LANG="en-US"><I>,
	x</I></SPAN><SUB><SPAN LANG="en-US"><I>2</I></SPAN></SUB><SPAN LANG="en-US"><SPAN STYLE="font-style: normal">
	&ndash; wartoœci wejœciowe</SPAN></SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm"><SPAN LANG="en-US"><I><SPAN STYLE="font-weight: normal">n
	&ndash; </SPAN></I></SPAN><SPAN LANG="en-US"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">niewielki
	wsp</SPAN></SPAN></SPAN><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">ó³czynnik
	uczenia (</SPAN></SPAN><I><SPAN STYLE="font-weight: normal">n</SPAN></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
	&gt; 0)</SPAN></SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm"><I><SPAN STYLE="font-weight: normal">d
	</SPAN></I><SPAN LANG="en-US"><I><SPAN STYLE="font-weight: normal">&ndash;</SPAN></I></SPAN><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
	oczekiwana odpowiedŸ</SPAN></SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm"><I><SPAN STYLE="font-weight: normal">y</SPAN></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
	&ndash; odpowiedŸ perceptronu</SPAN></SPAN></P>
	<LI><P STYLE="margin-bottom: 0cm"><I><SPAN STYLE="font-weight: normal">b
	&ndash;</SPAN></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
	próg wzbudzenia perceptronu</SPAN></SPAN></P>
</UL>
<P STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Wyniki
uczenia perceptronu funkcji AND:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>data:
(0, 0), expected: 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>data:
(0, 1), expected: 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>data:
(1, 0), expected: 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>data:
(1, 1), expected: 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>------------
min iter number ------------</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.11125, 0.04797];Perceptron(weights:[ 0.60610,
0.29540],bias:-0.73244,learnRate:(0.24743),activFunc:'naturalOne');iterNumber:
6</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.36271, 0.02163];Perceptron(weights:[ 0.54192,
0.20084],bias:-0.68868,learnRate:(0.05974),activFunc:'naturalOne');iterNumber:
8</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.20559, 0.37193];Perceptron(weights:[ 0.20559,
0.37193],bias:-0.53006,learnRate:(0.07117),activFunc:'naturalOne');iterNumber:
1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.91847, 0.74637];Perceptron(weights:[ 0.67844,
0.74637],bias:-0.78546,learnRate:(0.24003),activFunc:'naturalOne');iterNumber:
4</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.10173, 0.04372];Perceptron(weights:[ 0.63168,
0.57367],bias:-0.87016,learnRate:(0.52995),activFunc:'naturalOne');iterNumber:
8</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.59095, 0.51119];Perceptron(weights:[ 0.59095,
0.51119],bias:-0.80593,learnRate:(0.15690),activFunc:'naturalOne');iterNumber:
1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.55768, 0.82703];Perceptron(weights:[ 0.16785,
0.82703],bias:-0.89607,learnRate:(0.38983),activFunc:'naturalOne');iterNumber:
4</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.44677, 0.82911];Perceptron(weights:[ 1.08580,
0.19007],bias:-1.13711,learnRate:(0.63903),activFunc:'naturalOne');iterNumber:
6</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.39117, 0.19288];Perceptron(weights:[ 0.49815,
0.29986],bias:-0.76528,learnRate:(0.05349),activFunc:'naturalOne');iterNumber:
6</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.14418, 0.78396];Perceptron(weights:[ 0.14418,
0.78396],bias:-0.79635,learnRate:(0.00887),activFunc:'naturalOne');iterNumber:
1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>------------
average iter number ------------</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.68320,
0.06877];Perceptron(weights:[ 0.07552,
0.41364],bias:-0.47807,learnRate:(0.06897),activFunc:'naturalOne');iterNumber:
72</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.12307,-0.02144];Perceptron(weights:[
0.28277,
0.38441],bias:-0.53646,learnRate:(0.08117),activFunc:'naturalOne');iterNumber:
25</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.84717,-0.40685];Perceptron(weights:[ 0.59654,
0.01563],bias:-0.60594,learnRate:(0.00716),activFunc:'naturalOne');iterNumber:
418</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.13209,-0.31436];Perceptron(weights:[ 0.50339,
0.13120],bias:-0.58636,learnRate:(0.07426),activFunc:'naturalOne');iterNumber:
25</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.02483, 0.30130];Perceptron(weights:[ 0.04921,
0.20377],bias:-0.23136,learnRate:(0.02438),activFunc:'naturalOne');iterNumber:
32</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.08147,
0.75077];Perceptron(weights:[ 0.13155,
0.37799],bias:-0.46029,learnRate:(0.05325),activFunc:'naturalOne');iterNumber:
103</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.36895,
0.26485];Perceptron(weights:[ 0.15907,
0.44085],bias:-0.53193,learnRate:(0.08800),activFunc:'naturalOne');iterNumber:
44</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.77574,-0.85672];Perceptron(weights:[
0.02537,
0.03339],bias:-0.04101,learnRate:(0.02967),activFunc:'naturalOne');iterNumber:
156</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.84950,-0.25015];Perceptron(weights:[
0.61523,
1.21458],bias:-1.50577,learnRate:(0.48824),activFunc:'naturalOne');iterNumber:
48</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.81392,-0.38371];Perceptron(weights:[ 0.32470,
1.08394],bias:-1.11197,learnRate:(0.48922),activFunc:'naturalOne');iterNumber:
19</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>------------
max iter number ------------</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.15419,-0.52632];Perceptron(weights:[
0.34978,
0.00358],bias:-0.35259,learnRate:(0.00162),activFunc:'naturalOne');iterNumber:
1330</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.00206,-0.97350];Perceptron(weights:[
0.19739,
0.00197],bias:-0.19772,learnRate:(0.00168),activFunc:'naturalOne');iterNumber:
2407</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.12709,
0.57907];Perceptron(weights:[ 0.00071,
0.32900],bias:-0.32969,learnRate:(0.00061),activFunc:'naturalOne');iterNumber:
2516</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.89681,
0.51395];Perceptron(weights:[ 0.00452,
0.49628],bias:-0.49976,learnRate:(0.00177),activFunc:'naturalOne');iterNumber:
2159</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.67283,
0.99432];Perceptron(weights:[ 0.00130,
0.55165],bias:-0.55284,learnRate:(0.00067),activFunc:'naturalOne');iterNumber:
6683</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.17183,-0.81148];Perceptron(weights:[
0.16453,
0.00265],bias:-0.16616,learnRate:(0.00137),activFunc:'naturalOne');iterNumber:
2365</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.79868,-0.77361];Perceptron(weights:[ 0.73151,
0.00323],bias:-0.73398,learnRate:(0.00172),activFunc:'naturalOne');iterNumber:
1953</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.51251,-0.44361];Perceptron(weights:[
0.01784,
0.08675],bias:-0.10459,learnRate:(0.00000),activFunc:'naturalOne');iterNumber:
19319407</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[-0.16550,-0.96391];Perceptron(weights:[
0.03108,
0.00691],bias:-0.03615,learnRate:(0.00302),activFunc:'naturalOne');iterNumber:
1356</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=1>initialWeights:[
0.34524,-0.97219];Perceptron(weights:[ 0.32921,
0.00012],bias:-0.32932,learnRate:(0.00006),activFunc:'naturalOne');iterNumber:
65743</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Dane
ucz¹ce by³y wybierane losowo z danych przedstawionych na pocz¹tku
wypisu. Po ka¿dorazowym &bdquo;nauczeniu&rdquo; perceptronu, by³ on
testowany na wszystkich mo¿liwych przypadkach</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>danych
ucz¹cych i sprawdzany, czy zwraca poprawny wynik, jeœli wynik nie by³
poprawny chocia¿ w jednym przypadku, perceptron by³ uczony jeszcze
raz.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Wagi
pocz¹tkowe by³y dobierane losowo, jako wartoœæ dodatnia lub ujemna,
bias by³ losow¹ wartoœci¹ ujemn¹.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Jak
widaæ w za³¹czonych wynikach istnieje zale¿noœæ miêdzy ró¿nymi
wspó³czynnikami uczenia (losowa wartoœæ dodatnia z zakresu [0,1) ), a
iloœci¹ potrzebnych iteracji do osi¹gniêcia zadowalaj¹cego wyniku &ndash;
im mniejszy &bdquo;learnRate&rdquo; tym wiêksza iloœæ iteracji i
d³u¿szy czas obliczeñ. Uda³o siê w tym przebiegu nawet ustaliæ na
tyle niski &bdquo;learnRate&rdquo;, który sprawi³, ¿e pêtla ucz¹ca
musia³a zmieniaæ stan wag ponad 19mln razy.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Stworzy³em
równie¿ obs³ugê funkcji XOR na sieci neuronowej z wsteczn¹
propagacj¹.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Listing
kodu:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>#
-*- coding: utf-8 -*-</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>&quot;&quot;&quot;</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>Created
on Tue Oct 10 19:39:26 2017</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>@author:
PiotrTutak</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>&quot;&quot;&quot;</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>import
numpy as np</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>from
itertools import zip_longest</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
ident(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
float(x)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
positiveIdent(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
x&lt;0:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
0.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
float(x)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
zero(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
0.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
Stable:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__call__(self,alfa):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
stable(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
float(alfa)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
stable</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
hardOne(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
x&lt;0:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
0.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
hardSign(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
x&lt;0:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
-1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
squash(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
x&lt;-1:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
-1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
x&gt;1:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
x</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
Sigm:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__call__(self,alfa):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
sigm(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
1.0/(1.0+np.exp(-alfa*x))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
sigm</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
derivative(self,alfa):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
sigmDeriv(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
alfa*np.exp(-alfa*x)/((1.0+np.exp(-alfa*x))**2)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
sigmDeriv</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
SignSigm:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__call__(self,alfa):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
sigm(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
(2.0/(1.0+np.exp(-alfa*x)))-1.0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
sigm</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
derivative(self,alfa):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
sigmDeriv(x):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
2.0*alfa*np.exp(-alfa*x)/((1.0+np.exp(-alfa*x))**2)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
sigmDeriv</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
Perceptron:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__init__(self, weights, activFunc, activFuncDeriv, learnRate=0.1,
bias=-0.8*np.random.ranf()-0.1):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_weights']=np.array(weights)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=learnRate</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_activFunc']=activFunc</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_activFuncDeriv']=activFuncDeriv</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_bias']=bias</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_error']=None</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_inputValues']=None</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_val']=None</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
learn(self,inputValues,expectedValue,learnRate=False):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
len(inputValues)!=len(self._weights):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
TypeError('Wrong values length')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
(learnRate):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=learnRate</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>s=np.dot(self._weights,inputValues)+self._bias</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>s=self._activFunc(s)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
i in range(len(self._weights)):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self._weights[i]+=self._learnRate*(expectedValue-s)*inputValues[i]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_bias']+=self._learnRate*(expectedValue-s)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
process(self,inputValues):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
len(inputValues)!=len(self._weights):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
TypeError('Wrong values length')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_inputValues']=np.array(inputValues)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_val']=np.dot(self._weights,self._inputValues)+self._bias</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._activFunc(self._val)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
propagateError(self,weights,errors):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>weights=np.array(weights)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>errors=np.array(errors)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
len(errors)!=len(weights):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
TypeError('Wrong values length')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_error']=np.dot(weights,errors)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
i in range(len(self._weights)):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self._weights[i]+=self._learnRate*self._error*self._inputValues[i]*self._activFuncDeriv(self._val)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_bias']+=self._learnRate*self._error*self._activFuncDeriv(self._val)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._error</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__setitem__(self,index,value):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
index=='learnRate':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=value</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__getitem__(self,index):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
index=='error':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._error</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
index=='input':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._inputValues</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
index=='value':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._val</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._weights[index]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__getattr__(self,attr):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
AttributeError('get: No such attribute: %r'%attr)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__setattr__(self,attr,value):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
AttributeError('set: No such attribute: %r'%attr)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__iter__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
iter(self._weights)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__len__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
len(self._weights)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__repr__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>w='['+','.join('{:8.5f}'.format(x)
for x in self._weights)+']'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
'Perceptron(weights:{0},bias:{1:8.5f},learnRate:{2:.5f},activFunc:{3!s})'.format(w,self._bias,self._learnRate,self._activFunc.__name__)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
Layer:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__init__(self,inputNumber,percepNumber,activFunc,activFuncDeriv,weights=False,learnRate=False,bias=False):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_inputNumber']=inputNumber</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_percepNumber']=percepNumber</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_activFunc']=activFunc</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_activFuncDeriv']=activFuncDeriv</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
weights:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>_weights=list(weights)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
inputNumber&gt;len(_weights):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">               
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>_weights.extend([np.random.ranf()*np.random.choice([-1.0,1.0])
for _ in range(inputNumber-len(_weights))])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>else:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>_weights=[np.random.ranf()*np.random.choice([-1.0,1.0])
for _ in range(inputNumber)]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
learnRate:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=learnRate</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>else:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=0.1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
bias:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>_bias=bias</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>else:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>_bias=-0.8*np.random.ranf()-0.1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_perceptrons']=[Perceptron(_weights[:inputNumber],activFunc,activFuncDeriv,bias=_bias,learnRate=self._learnRate)
for _ in range(percepNumber)]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__len__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
len(self._perceptrons)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__getitem__(self,index):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
index=='learnRate':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._learnRate</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._perceptrons[index]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__iter__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
iter(self._perceptrons)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__setitem__(self,index,value):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
index=='learnRate':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self.__dict__['_learnRate']=value</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in self._perceptrons:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>x['learnRate']*=value</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__getattr__(self,attr):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
AttributeError('get: No such attribute: %r'%attr)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__setattr__(self,attr,value):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
AttributeError('set: No such attribute: %r'%attr)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__repr__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result='Layer(inputNumber:{0},
perceptronNumber:{1},activFunc{2!s}, activFuncDeriv:{3!s},
learnRate:{4:.5f})'\</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">             
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>.format(self._inputNumber,self._percepNumber,self._activFunc.__name__,self._activFuncDeriv.__name__,self._learnRate)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
result</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__str__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result='Layer(inputNumber:{0},
perceptronNumber:{1},activFunc{2!s}, activFuncDeriv:{3!s},
learnRate:{4:.5f})'\</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">             
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>.format(self._inputNumber,self._percepNumber,self._activFunc.__name__,self._activFuncDeriv.__name__,self._learnRate)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+='\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
p in self:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+=str(p)+'\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
result</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>class
Multilayer:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__init__(self,layers,activFuncs=False,activFuncDerivs=False,weights=[False],
learnRates=[False], biases=[False]):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
isinstance(layers[0],Layer):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self._layers=layers</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
isinstance(layers[0],int):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
not all([activFuncs,activFuncDerivs]):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>raise
TypeError('Missing activation functions or derivatives')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>percepNumbers=layers</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>l=zip_longest(percepNumbers,activFuncs,activFuncDerivs,weights,learnRates,biases,fillvalue=None)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>prev=next(l)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>layerList=[Layer(1,*prev)]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in l:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">               
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>layerList.append(Layer(prev[0],*x))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>prev=x</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>self._layers=layerList</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__getitem__(self,index):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
self._layers[index]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__iter__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
iter(self._layers)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
process(self,inputValues):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inputValues=list(inputValues)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>values=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
p in self._layers[0]:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>values.append(p.process(inputValues[:len(p)]))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inputValues=inputValues[len(p):]
   </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
layer in self._layers[1:]:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inputValues=values</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>values=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
p in layer:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">               
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>values.append(p.process(inputValues))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
values</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
learn(self,inputValues,expectedValues):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>results=iter(self.process(inputValues))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>i=len(expectedValues)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>expectedValues=iter(expectedValues)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>errors=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
_ in range(i):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>errors.append([next(expectedValues)-next(results)])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>weights=[[1]
for _ in range(len(errors))]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
layer in reversed(self._layers):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>newErrors=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>oldWeights=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
p in layer:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>oldWeights.append(p[:])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">               
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>newErrors.append(p.propagateError(weights.pop(0),errors.pop(0)))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>weights=list(zip(*oldWeights))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>errors=[newErrors
for x in range(len(weights))]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__repr__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result='Multilayer:\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
layer in self._layers:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+=repr(layer)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+='\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
result</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>def
__str__(self):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result='Multilayer:\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
layer in self._layers:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+=str(layer)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result+='\n'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>return
result</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        
</P>
<P STYLE="margin-bottom: 0cm">                
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
__name__=='__main__':</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('Funkcja
AND:')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inputData=(</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((0,0),0),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((0,1),0),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((1,0),0),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((1,1),1)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in inputData:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(&quot;data:
{0}, expected: {1}&quot;.format(*x))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMin=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercAver=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMax=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>RES_NUMBER=10</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>while(len(listPercMin)&lt;RES_NUMBER
or len(listPercAver)&lt;RES_NUMBER or len(listPercMax)&lt;RES_NUMBER):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>w=[np.random.ranf()*np.random.choice([-1,1])
for _ in range(2)]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>p=Perceptron(w,hardOne,Stable()(1.0),learnRate=np.random.ranf()*np.random.ranf()*np.random.ranf(),bias=np.random.ranf()*-1.0)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>i=0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>while(True):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>cont=False</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>i+=1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inp=inputData[np.random.choice(len(inputData))]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>expected=inp[1]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>result=p.process(inp[0])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>p.propagateError([1],[expected-result])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
data,expected in inputData:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>r=p.process(data)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
r!=expected:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>cont=True</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>break</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
not cont:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>break</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>w='initialWeights:['+','.join('{:8.5f}'.format(x)
for x in w)+']'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
i&lt;10 and len(listPercMin)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMin.append((w,p,&quot;iterNumber:
%d&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
i&gt;=10 and i&lt;1000 and len(listPercAver)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercAver.append((w,p,&quot;iterNumber:
%d&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
i&gt;=1000 and len(listPercMax)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMax.append((w,p,&quot;iterNumber:
%d&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n------------
min iter number ------------\n')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercMin:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(*x,
sep=';')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n------------
average iter number ------------\n')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercAver:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(*x,
sep=';')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n------------
max iter number ------------\n')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercMax:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(*x,
sep=';')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('Funkcja
XOR:')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>xorInputData=(</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((0,0),[0]),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((0,1),[1]),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((1,0),[1]),</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>((1,1),[0])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMin=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercAver=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMax=[]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>RES_NUMBER=100</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">   
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>while(len(listPercMin)+len(listPercAver)+len(listPercMax)&lt;RES_NUMBER):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">       
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>mult=Multilayer([2,2,1],[hardSign,SignSigm()(1.0),hardOne],[zero,SignSigm().derivative(1.),Stable()(1.0)],weights=[[1.0]],learnRates=[0.0,3.0,.01],biases=[-0.5])</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>i=0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>while(True):</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>cont=False</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>i+=1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>inp=xorInputData[np.random.choice(len(xorInputData))]</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>mult.learn(*inp)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
data,expected in xorInputData:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>r=mult.process(data)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
r[0]!=expected[0]:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>cont=True</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>break</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
not cont:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>break</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
i&gt;5000:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">                <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>break</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>if
i&lt;10 and len(listPercMin)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMin.append((mult,&quot;iterNumber:
%d;&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
i&gt;=10 and i&lt;100 and len(listPercAver)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercAver.append((mult,&quot;iterNumber:
%d;&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>elif
i&gt;=100 and len(listPercMax)&lt;RES_NUMBER:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">           
<FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>listPercMax.append((mult,&quot;iterNumber:
%d;&quot;%i))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">            <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(i)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n------------
percentage ------------\n')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('min
iter: ',len(listPercMin),'; aver iter: ',len(listPercAver),'; max
iter: ',len(listPercMax))</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n\n------------
min iter number ------------')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercMin:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(x[1],end='
')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n\n------------
average iter number ------------')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercAver:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(x[1],end='
')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n\n------------
max iter number ------------')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>for
x in listPercMax:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">        <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print(x[1],end='
')</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">    <FONT FACE="Calibri Light, sans-serif"><FONT SIZE=2>print('\n')</FONT></FONT></P>
</BODY>
</HTML>